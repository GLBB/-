# 可用的垃圾收集器

> 作于 2019/9/13

## Serial  收集器

单线程进行垃圾回收，没有线程间的通信消耗。

不能利用多核，适用于小堆（100MB左右）

-XX:+UseSerialGC : 启用该垃圾收集器

## Parallel 收集器

基于分代收集，吞吐量优先的垃圾收集器，和 Serial  收集器不同之处在于能利用多核优势，多线程进行垃圾收集。

该垃圾收集器使用中等或大数据集进行垃圾收集。

-XX:+UseParallelGC ：启用该垃圾收集器。

Parallel 收集器在 major GC 时，会对老年代进行压缩。

-XX:-UseParallelOldGC ：使用Serial  收集器回收老年代。

## 并发垃圾收集器

G1 垃圾收集器

* 能利用多核优势，使用与大内存，满足垃圾收集过程中停顿时间的预期，同时也有比较高的吞吐量。
* -XX:+UseG1GC ：启用该垃圾收集器

CMS 垃圾收集器

* 目标是减少垃圾收集过程中停顿的现象
* -XX:+UseConcMarkSweepGC  启用该垃圾收集器
* 在 jdk9 已经被标记为过时了

## Z 收集器 

具有可扩展，低延迟，不需要停止应用线程。

量化低延迟：少于 10ms 停顿，适用于超大堆：TB 级别。

-XX:+UseZGC ：启用该垃圾收集器。

目前是实验特性，JDK11 搭载 ZGC。

## 收集器的选择

除非有停顿时间的要求，最好使用默认的垃圾收集器。

首先先调整堆的大小，如果性能不能满足要求，在选择垃圾收集器。

* 如果应用是小数据集，选择 serial 收集器
* 如果单核，同时没有停顿时间的需要，选择 serial 收集器
* 吞吐量优先，能接受秒级延时，选择 Parallel 收集器
* 如果响应时间是比总的吞吐量重要，停顿时间小于 1s, 可以选择 G1或 CMS.
* 如果响应时间是高优先级，或者有一个大堆，可以选择 ZGC。

如果默认的收集器不能满足性能要求，首先调整堆大小，年轻代和老年代的比例，还不能满足性能要求，在选择垃圾收集器。