# 垃圾收集器调优介绍

## 什么是垃圾收集器

应用程序占用的内存是动态变化的，垃圾收集器自动管理应用程序占用的内存。

垃圾收集器动态内存管理通过以下几个方面：

* 归还从操作系统申请的内存
* 满足应用程序申请内存的需求
* 决定应用程序使用内存的哪部分
* 回收应用程序没有使用的内存

HotSpot 垃圾收集器为上面四个方面所作的优化：

* 使用分代回收结合对象年龄机制。该方法产生的结果：在最短时间，可以从堆回收大量空闲区域。
* 使用多线程，尽量使操作并行化，或者需要长期运行的操作可以和程序并发运行。
* 使用压缩技术，将存活的对象放在一起，减少内存碎片，恢复连续内存空间。



## 为什么选择垃圾收集器是重要的

如果目前的垃圾收集器停顿时间和垃圾收集频率适中，可以不需要选择垃圾收集器。可是，对于大型程序，特别有大量的数据（以 G 为单位）和线程的，和高事务率，选择一个合适的垃圾收集器是必要的。

Amdahl's 定律：程序有可以并行的部分和串行的部分，有些部分只能串行执行，所以并行加速只能加速并行的部分。Java 应用程序可供选者的垃圾收集器目前有四个，其中之一：serial GC。serialGC 收集提高垃圾收集效率，更重要的一个特性是，尽可能减少垃圾收集的开销。

下面一个图 1-1 描述了 SerialGC 吞吐量和处理器数量及GC花费时间占比。

![](../img/1-1.png)

可以发现，在小系统上可以忽略的吞吐量问题，在大系统上可能会成为性能瓶颈，所以在大系统上选择一个合适的垃圾收集器是重要的。

Serial GC 垃圾收集器能满足大多数小应用程序的需求。如预估应用程序内存占用100M 左右，就可以使用 Serial GC。

在多线程应用程序运行在有大内存，多核的机器的场景中，默认使用的 G1 GC。

